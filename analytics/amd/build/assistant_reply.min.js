define(["jquery","core/config","core/notification","core_message/message_repository"],function(a,b,c,d){return{forMe:function(a){if(2!=a.members.length)return!1;if("undefined"==typeof b.assistantuserid)return console.error("No $CFG->assistantuserid defined"),!1;for(i in a.members)if(userid=a.members[i].id,userid!==a.loggedInUserId&&userid==parseInt(b.assistantuserid)&&(lastMessage=a.messages[a.messages.length-1],lastMessage.fromloggedinuser===!0))return!0;return!1},forwardMessage:function(b,e){var f=a(e.text).text();return d.sendMessageToAssistant(b,f).then(function(a){a.redirect?window.location.href=a.redirect:a.replies&&console.log(a.replies),a.warnings&&c.exception(new Error(a.warnings[0].message))})["catch"](c.exception)}}});